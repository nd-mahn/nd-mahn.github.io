<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giao Thừa Rực Rỡ 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Montserrat:wght@800&display=swap" rel="stylesheet">
    <!-- Thư viện tạo mã QR -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
        body { margin: 0; padding: 0; background: #000; overflow: hidden; font-family: 'Montserrat', sans-serif; color: #fff; }
        canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }

        #content-wrapper {
            position: relative; z-index: 10; height: 100vh;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center; pointer-events: none;
        }

        /* Countdown */
        .countdown-ui h1 { font-size: 2.5rem; color: #ffd700; text-shadow: 0 0 20px #ff4500; margin-bottom: 2rem; }
        #timer { display: flex; gap: 15px; }
        .time-box { background: rgba(255, 0, 0, 0.2); backdrop-filter: blur(10px); padding: 20px; border-radius: 15px; min-width: 90px; border: 2px solid #ffd700; box-shadow: 0 0 15px rgba(255, 215, 0, 0.5); }
        .time-box span { display: block; font-size: 3rem; font-weight: 800; }

        /* Lời chúc */
        #wish-container { display: none; }
        .wish-text {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.5rem;
            line-height: 1.5;
            color: #ffd700;
            text-shadow: 0 0 20px #ff0000, 0 0 10px #fff;
            max-width: 850px;
            margin: 0 auto;
            padding: 0 20px;
            word-wrap: break-word;
            opacity: 0;
            transform: translateY(30px);
            transition: all 1.2s ease-in-out;
        }
        @media (max-width: 768px) {
            .wish-text { font-size: 1.6rem; max-width: 90%; }
            .countdown-ui h1 { font-size: 1.8rem; }
            .time-box { min-width: 60px; padding: 10px; }
            .time-box span { font-size: 1.8rem; }
        }
        .wish-text.active { opacity: 1; transform: translateY(0); }

        /* Nút Preview */
        #btnPreview {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
            z-index: 100; padding: 15px 35px;
            background: linear-gradient(45deg, #ff0000, #ffd700); border: none;
            border-radius: 50px; color: #000; font-weight: bold; cursor: pointer;
            box-shadow: 0 0 20px #ff4500;
        }

        /* QR CODE ở góc phải */
        #qr-wrapper {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.85);
            padding: 10px;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.4);
            transition: transform 0.3s ease;
            pointer-events: auto; /* Cho phép tương tác */
        }
        #qr-wrapper:hover { transform: scale(1.1); }
        #qrcode { margin-bottom: 5px; }
        #qr-wrapper span { color: #000; font-size: 10px; font-weight: 900; }
    </style>
</head>
<body>

<canvas id="fireworksCanvas"></canvas>

<div id="content-wrapper">
    <div id="countdown-ui" class="countdown-ui">
        <h1>TẾT BÍNH NGỌ 2026 SAU</h1>
        <div id="timer">
            <div class="time-box"><span id="days">00</span><small>NGÀY</small></div>
            <div class="time-box"><span id="hours">00</span><small>GIỜ</small></div>
            <div class="time-box"><span id="mins">00</span><small>PHÚT</small></div>
            <div class="time-box"><span id="secs">00</span><small>GIÂY</small></div>
        </div>
    </div>

    <div id="wish-container">
        <h2 id="wish-display" class="wish-text">CHÚC MỪNG NĂM MỚI</h2>
    </div>
</div>

<button id="btnPreview" onclick="triggerGiaoThua()">BẮN PHÁO HOA GIAO THỪA</button>

<div id="qr-wrapper">
    <div id="qrcode"></div>
    <span>QUÉT ĐỂ XEM</span>
</div>

<script>
    // 1. KHỞI TẠO QR CODE
    new QRCode(document.getElementById("qrcode"), {
        text: window.location.href, // Tự động lấy link trang này
        width: 85,
        height: 85,
        colorDark : "#000000",
        colorLight : "#ffffff",
        correctLevel : QRCode.CorrectLevel.H
    });

    // 2. LOGIC PHÁO HOA
    const canvas = document.getElementById('fireworksCanvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let fireworks = [];
    let particles = [];
    let isGiaoThua = false;

    class Firework {
        constructor(targetX, targetY) {
            this.x = Math.random() * canvas.width;
            this.y = canvas.height;
            this.targetX = targetX || Math.random() * canvas.width;
            this.targetY = targetY || Math.random() * (canvas.height * 0.5);
            this.angle = Math.atan2(this.targetY - this.y, this.targetX - this.x);
            this.speed = 2;
            this.acceleration = 1.05;
            this.brightness = Math.random() * 50 + 50;
            this.coordinates = [[this.x, this.y], [this.x, this.y], [this.x, this.y]];
        }
        update(index) {
            this.coordinates.pop();
            this.coordinates.unshift([this.x, this.y]);
            this.speed *= this.acceleration;
            if(this.y <= this.targetY) {
                createParticles(this.targetX, this.targetY);
                fireworks.splice(index, 1);
            } else {
                this.x += Math.cos(this.angle) * this.speed;
                this.y += Math.sin(this.angle) * this.speed;
            }
        }
        draw() {
            ctx.beginPath();
            ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
            ctx.lineTo(this.x, this.y);
            ctx.strokeStyle = `hsl(${Math.random() * 360}, 100%, ${this.brightness}%)`;
            ctx.stroke();
        }
    }

    class Particle {
        constructor(x, y, hue) {
            this.x = x; this.y = y;
            this.hue = hue;
            this.angle = Math.random() * Math.PI * 2;
            this.speed = Math.random() * 10 + 1;
            this.friction = 0.95;
            this.gravity = 1;
            this.alpha = 1;
            this.decay = Math.random() * 0.03 + 0.015;
            this.coordinates = [[this.x, this.y], [this.x, this.y], [this.x, this.y], [this.x, this.y], [this.x, this.y]];
        }
        update(index) {
            this.coordinates.pop();
            this.coordinates.unshift([this.x, this.y]);
            this.speed *= this.friction;
            this.x += Math.cos(this.angle) * this.speed;
            this.y += Math.sin(this.angle) * this.speed + this.gravity;
            this.alpha -= this.decay;
            if(this.alpha <= this.decay) particles.splice(index, 1);
        }
        draw() {
            ctx.beginPath();
            ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
            ctx.lineTo(this.x, this.y);
            ctx.strokeStyle = `hsla(${this.hue}, 100%, 50%, ${this.alpha})`;
            ctx.stroke();
        }
    }

    function createParticles(x, y) {
        let particleCount = 150;
        let hue = Math.random() * 360;
        while(particleCount--) particles.push(new Particle(x, y, hue));
    }

    function loop() {
        requestAnimationFrame(loop);
        ctx.globalCompositeOperation = 'destination-out';
        ctx.fillStyle = 'rgba(0, 0, 0, 0.25)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.globalCompositeOperation = 'lighter';
        let i = fireworks.length;
        while(i--) { fireworks[i].draw(); fireworks[i].update(i); }
        let j = particles.length;
        while(j--) { particles[j].draw(); particles[j].update(j); }
        let launchRate = isGiaoThua ? 0.15 : 0.03;
        if(Math.random() < launchRate) fireworks.push(new Firework());
    }

    // 3. LOGIC GIAO THỪA & LỜI CHÚC
    const wishes = [
        "CHÚC MỪNG NĂM MỚI LINH VÀ GIA ĐÌNH NHÉ!",
        "CHÚC CẢ NHÀ MÌNH MỘT NĂM MỚI THẬT NHIỀU SỨC KHỎE, BÌNH AN VÀ MỌI DỰ ĐỊNH ĐỀU HANH THÔNG.",
        "CHÚC RIÊNG EM NĂM MỚI LUÔN GIỮ ĐƯỢC NĂNG LƯỢNG TÍCH CỰC, CÔNG VIỆC THUẬN LỢI VÀ CÓ THẬT NHIỀU NIỀM VUI",
        "ĐÓN GIAO THỪA ẤM ÁP BÊN GIA ĐÌNH NHÉ!",
    ];
    let wishIndex = 0;

    function triggerGiaoThua() {
        if(isGiaoThua) return;
        isGiaoThua = true;
        document.getElementById("countdown-ui").style.display = "none";
        document.getElementById("btnPreview").style.display = "none";
        document.getElementById("wish-container").style.display = "block";

        const updateWish = () => {
            const display = document.getElementById("wish-display");
            display.classList.remove("active");
            setTimeout(() => {
                display.innerText = wishes[wishIndex];
                display.classList.add("active");
                wishIndex = (wishIndex + 1) % wishes.length;
            }, 600);
        };

        updateWish();
        setInterval(updateWish, 6000); // 6 giây đổi câu một lần
        for(let i=0; i<10; i++) setTimeout(() => fireworks.push(new Firework()), i*200);
    }

    // Đếm ngược
    const target = new Date("February 17, 2026 00:00:00").getTime();
    setInterval(() => {
        const diff = target - new Date().getTime();
        if(diff <= 0 && !isGiaoThua) { triggerGiaoThua(); return; }
        document.getElementById("days").innerText = Math.floor(diff / (1000 * 60 * 60 * 24));
        document.getElementById("secs").innerText = String(Math.floor((diff % (1000 * 60)) / 1000)).padStart(2, '0');
        document.getElementById("mins").innerText = String(Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60))).padStart(2, '0');
        document.getElementById("hours").innerText = String(Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60))).padStart(2, '0');
    }, 1000);

    window.addEventListener('mousedown', (e) => fireworks.push(new Firework(e.clientX, e.clientY)));
    loop();
</script>
</body>
</html>